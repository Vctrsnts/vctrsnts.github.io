<!DOCTYPE html>
<!--
    Type on Strap jekyll theme v2.4.9
    Theme free for personal and commercial use under the MIT license
    https://github.com/sylhare/Type-on-Strap/blob/master/LICENSE
-->
<html lang="en">
  
  <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.5, maximum-scale=5"> <!-- Theme Mode--> <script> const darkBtn = "Dark"; const lightBtn = "Light"; const isAutoTheme = false; const preferredTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'; if (isAutoTheme) { document.documentElement.setAttribute('data-theme', sessionStorage.getItem('theme') ?? preferredTheme); } else { document.documentElement.setAttribute('data-theme', "dark"); } </script> <!-- Main JS (navbar.js, katex_init.js and masonry_init.js)--> <script defer src="/assets/js/main.min.js"></script> <!-- CSS --> <link rel="stylesheet" href="/assets/css/main.css"> <!--Favicon--> <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon"> <!-- KaTeX 0.16.9 --> <!-- Mermaid 10.8.0 --> <script defer src="/assets/js/vendor/mermaid.min.js"></script> <!-- Simple Jekyll Search 1.10.0 --> <script src="/assets/js/vendor/simple-jekyll-search.min.js" type="text/javascript"></script> <!-- Google Analytics / Cookie Consent --> <script> const cookieName = 'cookie-notice-dismissed-https://vctrsnts.github.io'; const isCookieConsent = 'false'; const analyticsName = ''; const analyticsNameGA4 = ''; </script> <!-- seo tags --> <meta property="og:image" content="https://vctrsnts.github.io/assets/img/header/logo.png"> <meta property="og:type" content="website" /> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Publicar feed en Mastodon / Twitter | Si lo haces, hazlo bien!</title> <meta name="generator" content="Jekyll v4.3.3" /> <meta property="og:title" content="Publicar feed en Mastodon / Twitter" /> <meta name="author" content="VSANTOS" /> <meta property="og:locale" content="es_ES" /> <meta name="description" content="Descubri a traves del Blog de Lazaro, que si tienes cuenta en Mastodon, quien no tiene cuenta ahora tal como van las cosas en Twitter, que puedes enviar de forma aleatoria alguno de los articulos que tienes publicados en tu web." /> <meta property="og:description" content="Descubri a traves del Blog de Lazaro, que si tienes cuenta en Mastodon, quien no tiene cuenta ahora tal como van las cosas en Twitter, que puedes enviar de forma aleatoria alguno de los articulos que tienes publicados en tu web." /> <link rel="canonical" href="https://vctrsnts.github.io/debian%20gnu/linux/python/2022/11/14/publicar-feed-mastodon.html" /> <meta property="og:url" content="https://vctrsnts.github.io/debian%20gnu/linux/python/2022/11/14/publicar-feed-mastodon.html" /> <meta property="og:site_name" content="Si lo haces, hazlo bien!" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2022-11-14T00:00:00+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Publicar feed en Mastodon / Twitter" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"VSANTOS","url":"https://github.com/vctrsnts"},"dateModified":"2022-11-14T00:00:00+00:00","datePublished":"2022-11-14T00:00:00+00:00","description":"Descubri a traves del Blog de Lazaro, que si tienes cuenta en Mastodon, quien no tiene cuenta ahora tal como van las cosas en Twitter, que puedes enviar de forma aleatoria alguno de los articulos que tienes publicados en tu web.","headline":"Publicar feed en Mastodon / Twitter","mainEntityOfPage":{"@type":"WebPage","@id":"https://vctrsnts.github.io/debian%20gnu/linux/python/2022/11/14/publicar-feed-mastodon.html"},"url":"https://vctrsnts.github.io/debian%20gnu/linux/python/2022/11/14/publicar-feed-mastodon.html"}</script> <!-- End Jekyll SEO tag --> <!-- RSS --> <link rel="alternate" type="application/atom+xml" title="Si lo haces, hazlo bien!" href="https://vctrsnts.github.io/feed.xml"/> <link type="application/atom+xml" rel="alternate" href="https://vctrsnts.github.io/feed.xml" title="Si lo haces, hazlo bien!" /> <!-- Twitter Cards --> <meta name="twitter:title" content="Publicar feed en Mastodon / Twitter"> <meta name="twitter:description" content="Descubri a traves del Blog de Lazaro, que si tienes cuenta en Mastodon, quien no tiene cuenta ahora tal como van las cosas en Twitter, que puedes enviar de ..."> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="https://vctrsnts.github.io/assets/img/header/triangular.jpeg"> <meta name="twitter:image:alt" content="Publicar feed en Mastodon / Twitter"> </head>
  <body>
    
    <header class="site-header"> <!-- Logo and title --> <div class="branding"> <a href="/"> <img alt="logo img" class="avatar" src="/assets/img/logo.png" loading="lazy"/> </a> <a class="site-title" aria-label="Si lo haces, hazlo bien!" href="/"> Si lo haces, hazlo bien! </a> </div> <!-- Toggle menu --> <nav class="clear"> <a aria-label="pull" id="pull" class="toggle" href="#"> <i class="fas fa-bars fa-lg"></i> </a> <!-- Menu --> <ul class="hide"> <li class="separator"> | </li> <li> <a class="clear" aria-label="About" title="About" href="/about/"> <span class="navbar-label ">About</span> </a> </li> <li class="separator"> | </li> <li> <a class="clear" aria-label="Archivo" title="Archivo" href="/archive"> <span class="navbar-label ">Archivo</span> </a> </li> <li class="separator"> | </li> <li> <a class="clear" aria-label="Tags" title="Tags" href="/tags/"> <i class="navbar-icon fas fa-tags" aria-hidden="true"></i> <span class="navbar-label navbar-label-with-icon">Tags</span> </a> </li> <li class="separator"> | </li> <li> <a class="clear" aria-label="Search" title="Search" href="/search/"> <i class="navbar-icon fas fa-search" aria-hidden="true"></i> <span class="navbar-label navbar-label-with-icon">Search</span> </a> </li> </ul> </nav> </header>
    <div class="content">
      <article >
    <header id="main" style="">
        <div class="title-padder">
            
                <h1 id="Publicar+feed+en+Mastodon+%2F+Twitter" class="title">Publicar feed en Mastodon / Twitter</h1>
                


<div class="post-info"><a href="https://github.com/vctrsnts" target="_blank" rel="noopener">
      <img alt="Author's avatar" src="https://avatars2.githubusercontent.com/u/816965?s=460&v=4" loading="lazy">
    
    <p class="meta">
      VSANTOS - 
      
      Noviembre 14, 2022
    </p></a></div>

            
        </div>
    </header>

    <section class="post-content">
    
            <p>Descubri a traves del <a href="https://elblogdelazaro.org">Blog de Lazaro</a>, que si tienes cuenta en <code class="language-plaintext highlighter-rouge">Mastodon</code>, quien no tiene cuenta ahora tal como van las cosas en <code class="language-plaintext highlighter-rouge">Twitter</code>,  que puedes enviar de forma aleatoria alguno de los articulos que tienes publicados en tu web.</p>

<!-- more -->

<p>Asi que después de leer su articulo y ver si yo podia hacer lo mismo, me lie la manta a la cabeza y al lio.</p>

<p>Lo primero, es tener una cuenta y después tienes que crear un aplicación en <code class="language-plaintext highlighter-rouge">Mastodon</code> de igual forma que se puede crear en Twitter (explicación más adelante ).</p>

<p>Aprovechando que en el servidor ya tengo Python instalado, hare que se ejecute en el mismo servidor. Eso si, también tienes que instalar:</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">   usuari@debian:~$</span><span class="w"> </span>pip <span class="nb">install</span> <span class="nt">--user</span> feddparser mastodon
</code></pre></div></div>

<p>Para que Python pueda realizar el tratamiento del fichero <code class="language-plaintext highlighter-rouge">xml</code>.</p>

<p>Una vez que ya tienes la aplicación creada, tienes que crear un fichero en <code class="language-plaintext highlighter-rouge">Python</code> que tiene que tener la siguiente estructura:</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">   #</span><span class="o">!</span>/usr/bin/env python
<span class="gp">   #</span><span class="w"> </span>-<span class="k">*</span>- coding: utf-8 -<span class="k">*</span>-
<span class="go"> 
</span><span class="gp">   #</span><span class="w"> </span>el fitxer original es de Carlos M. <span class="o">(</span>https://elblogdelazaro.org <span class="o">)</span>
<span class="go"> 
</span><span class="gp">   #</span><span class="w"> </span>Tens que tindre instalats les llibreries feedparser, Mastodon
<span class="go"> 
</span><span class="gp">   #</span><span class="w"> </span>Realitzem la crida als moduls de Python
<span class="go">   import feedparser
   import random
   from mastodon import Mastodon
 
</span><span class="gp">   #</span><span class="w"> </span>Reallitzem la crida a les claus del Diccionari
<span class="go">   CUSTOMER_KEY = 'xxxxxxxxxxxxxxx'
   CUSTOMER_SECRET = 'xxxxxxxxxxxxxxxxx'
   ACCESS_TOKEN = 'xxxxxxxxxxxx'
   ACCESS_TOKEN_SECRET = 'xxxxxxxxxxxxxxxxxxx'
 
</span><span class="gp">   #</span><span class="w"> </span>Informem de l<span class="s1">'adreça del feed
</span><span class="go">   feed = 'tu dirección web hacia el feed.xml'
 
</span><span class="gp">   #</span><span class="w"> </span>Descodifiquem el feed <span class="o">(</span>arxiu XML<span class="o">)</span>
<span class="go">   d = feedparser.parse(feed)
 
</span><span class="gp">   #</span><span class="w"> </span>Obtenim la longitud del feed i aleatoriament seleccionem un article
<span class="go">   feedlen = len(d['entries'])
   num = random.randint(0, feedlen)
 
</span><span class="gp">   #</span><span class="w"> </span>Iniciem l<span class="s1">'API de Mastodon, i escribim l'</span>estat
<span class="go">   status_text = d['entries'][num]['title'] + '\n' + d['entries'][num]['link']
   articulo = ("Recordando artículos publicados:" + '\n' + status_text)

</span><span class="gp">   #</span><span class="w"> </span>Token y url de la Instancia
<span class="go">   mastodon = Mastodon(
     access_token = 'XXXXXXXXXXXXXXXXXXXXXXX',
     api_base_url = 'https://mastodon.online/'
   )
</span><span class="gp">   #</span><span class="w"> </span>Publiquem a Mastodon
<span class="go">   mastodon.status_post(articulo)
</span></code></pre></div></div>

<p>Lo que tienes que tener en cuenta, es informar correctamente de:</p>
<ul>
  <li><strong>CUSTOMER_KEY</strong></li>
  <li><strong>CUSTOMER_SECRET</strong></li>
  <li><strong>ACCESS_TOKEN</strong></li>
  <li><strong>ACCESS_TOKEN_SECRET</strong></li>
  <li><strong>feed</strong></li>
</ul>

<p>Una vez, tengas el fichero creado, si quieres hacer pruebas, tienes que hacerlo de la siguiente manera :</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">   usuari@debian:~$</span><span class="w"> </span>python3 nombreDelArchivo.py
</code></pre></div></div>

<p>Entonces, si no has tenido ningun problema, a tu cuenta de Mastodon te llegara un articulo aleatorio de tu web.</p>

<p>Después de hacer las pruebas que creas oportunas, solo te quedara configurar el cron, para que se ejecute cuando tu quieras.</p>

<p>Yo lo tengo a que lo haga una vez a la semana, pero me estoy replanteando cambiarlo a que lo haga 3 veces por semana, porque a veces, añado articulos, que a lo mejor cuestan mucho a que salgan. Se que hay otro script, que lo que hace es publicar los ultimos articulos creados. Pero eso lo tengo que estudiar.</p>

<p>También tengo en cuenta, que si lo hago 3 veces a la semana (publicar toot) creare muchos mensajes, pero lo que también se puede hacer, es configurar Mastodon, para que elimine todos los toot con más de 6 meses de antigüedad (o menos).</p>

<p>Para la configuración del <code class="language-plaintext highlighter-rouge">CRON</code> lo tengo de la siguiente manera:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   @weekly /usr/bin/python3 /home/tu_usuario/lugar_donde_tengas_el_script/botMastodonPythonRss.py
</code></pre></div></div>

<p>En el caso de que lo quisieras hacer funcionar en <code class="language-plaintext highlighter-rouge">Twitter</code> tienes que tener en cuenta las siguientes modificaciones al archivo de <code class="language-plaintext highlighter-rouge">Python</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="c1"># En vez de usar la libreria "Mastodon" de Python, tienes que usar "Twython"
</span>   <span class="kn">from</span> <span class="n">twython</span> <span class="kn">import</span> <span class="n">Twython</span>

   <span class="n">api</span> <span class="o">=</span> <span class="nc">Twython</span><span class="p">(</span><span class="n">CONSUMER_KEY</span><span class="p">,</span><span class="n">CONSUMER_SECRET</span><span class="p">,</span><span class="n">ACCESS_KEY</span><span class="p">,</span><span class="n">ACCESS_SECRET</span><span class="p">)</span>

</code></pre></div></div>

<p>Y luego, solamente tienes que añadir la siguiente linea para publicar el articulo en <code class="language-plaintext highlighter-rouge">Twitter</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="n">api</span><span class="p">.</span><span class="nf">update_status</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">articulo</span><span class="p">)</span>
</code></pre></div></div>

<p>Espero que te sirva tanto como me ha servido a mi. Y eso si, no se te olvide darle las gracias a <a href="http://elblogdelazaro.org">Carlos M</a> por el increible articulo en que me he basado yo.</p>

<h4 id="referencia">Referencia</h4>
<ul>
  <li><a href="https://elblogdelazaro.org/posts/2021-08-16-bot-en-python-para-publicar-un-feed-de-forma-aleatorios-en-twitter-y-mastodom/">Script de Python</a></li>
</ul>


    
    </section>

    <!-- Social media shares -->
    
 
  




    <!-- Tag list -->
    
    


  <div class="tag-list">
    <ul>
      
        <li class="meta">Tags</li>
      

      
        <li><a class="button" href="/tags#Debian+GNU%2FLinux">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> Debian GNU/Linux</p>
        </a></li>
      
        <li><a class="button" href="/tags#Python">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> Python</p>
        </a></li>
      
    </ul>
  </div>



</article>




<!-- To change color of links in the page --> <style> header#main { background-size: cover; background-repeat: no-repeat; background-position: center; } </style> <!-- Post navigation --> <div id="post-nav"> <div id="previous-post"> <a alt="Script para actualizar tu GitHub" href="/debian%20gnu/linux/2022/11/22/script-update-git.html"> <p>Previous post</p> Script para actualizar tu GitHub </a> </div> <div id="next-post"> <a alt="Mi nuevo mediacenter - Thinkcenter m710q" href="/hardware/raspberry%20pi/thinkcenter/2022/11/08/cambiando-mediacenter.html"> <p>Next post</p> Mi nuevo mediacenter - Thinkcenter m710q </a> </div> </div> <!--Utterances--> <!-- Cusdis --> <!-- Disqus -->


    </div>
    
    <footer class="site-footer"> <ul> <a href="https://creativecommons.org/licenses/by-nc/4.0/deed.ca" title="This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License" target="_blank" rel="noopener"> <span class="fa-stack fa-lg"><i class="fab fa-creative-commons fa-stack fa-lg"></i></span><span class="fa-stack fa-lg"><i class="fab fa-creative-commons-by fa-stack fa-lg"></i></span><span class="fa-stack fa-lg"><i class="fab fa-creative-commons-nc-eu fa-stack fa-lg"></i></span> </a> </ul> <p class="text"> Powered by <a href="https://jekyllrb.com/">Jekyll</a> with <a href="https://github.com/sylhare/Type-on-Strap">Type on Strap</a> </p> <div class="footer-icons"> <ul> <!-- Social icons from Font Awesome, if enabled --> <li> <a feed.xml href="/feed.xml" title="Follow RSS feed" target="_blank"> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fas fa-rss fa-stack-1x fa-inverse"></i> </span> </a> </li> <li> <a href="https://github.com/vctrsnts" title="Follow on Github" target="_blank" rel="noopener"> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-github fa-stack-1x fa-inverse"></i> </span> </a> </li> <li> <a href="https://mastodon.online/@vsantos" title="Follow on Mastodon" target="_blank" rel="noopener"> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-mastodon fa-stack-1x fa-inverse"></i> </span> </a> </li> <li> <a href="https://vctrsnts.tumblr.com/" title="Follow on Tumblr" target="_blank" rel="noopener"> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-tumblr fa-stack-1x fa-inverse"></i> </span> </a> </li> <li> <a href="https://vsantos.wordpress.com/" title="Follow on Wordpress" target="_blank" rel="noopener"> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-wordpress fa-stack-1x fa-inverse"></i> </span> </a> </li> </ul> </div> <script type="module"> mermaid.initialize({ startOnLoad: false, theme: "default" }); mermaid.run({ nodes: [...document.querySelectorAll('.language-mermaid'), ...document.querySelectorAll('.mermaid')] }); </script> </footer>
  </body>
</html>
