<!DOCTYPE html>
<!--
    Type on Strap jekyll theme v2.4.9
    Theme free for personal and commercial use under the MIT license
    https://github.com/sylhare/Type-on-Strap/blob/master/LICENSE
-->
<html lang="en">
  
  <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.5, maximum-scale=5"> <!-- Theme Mode--> <script> const darkBtn = "Dark"; const lightBtn = "Light"; const isAutoTheme = false; const preferredTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'; if (isAutoTheme) { document.documentElement.setAttribute('data-theme', sessionStorage.getItem('theme') ?? preferredTheme); } else { document.documentElement.setAttribute('data-theme', "dark"); } </script> <!-- Main JS (navbar.js, katex_init.js and masonry_init.js)--> <script defer src="/assets/js/main.min.js"></script> <!-- CSS --> <link rel="stylesheet" href="/assets/css/main.css"> <!--Favicon--> <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon"> <!-- KaTeX 0.16.9 --> <script defer src="/assets/js/vendor/katex.min.js"></script> <script defer src="/assets/js/vendor/katex.auto-render.min.js" onload="renderMathInElement(document.body);"></script> <!-- Mermaid 10.8.0 --> <script defer src="/assets/js/vendor/mermaid.min.js"></script> <!-- Simple Jekyll Search 1.10.0 --> <script src="/assets/js/vendor/simple-jekyll-search.min.js" type="text/javascript"></script> <!-- Google Analytics / Cookie Consent --> <script> const cookieName = 'cookie-notice-dismissed-https://vctrsnts.github.io'; const isCookieConsent = 'false'; const analyticsName = ''; const analyticsNameGA4 = ''; </script> <!-- seo tags --> <meta property="og:image" content="https://vctrsnts.github.io/assets/img/header/logo.png"> <meta property="og:type" content="website" /> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Crear imagenes en docker | Si lo haces, hazlo bien!</title> <meta name="generator" content="Jekyll v4.3.3" /> <meta property="og:title" content="Crear imagenes en docker" /> <meta name="author" content="VSANTOS" /> <meta property="og:locale" content="es_ES" /> <meta name="description" content="Esto es una cosa que queria hacer desde que he empezado a utilizar docker porque siempre va bien tenerlos apuntado por si algun momento hace falta y si además te has hecho algun par de containers propios, pues nunca esta de más. La parte más dificil de crear una imagen docker, es el Dockerfile, este fichero es todo lo que contendra y hara la imagen docker cuando se cree (sobre que base funciona, que puertos, volumenes, etc…)." /> <meta property="og:description" content="Esto es una cosa que queria hacer desde que he empezado a utilizar docker porque siempre va bien tenerlos apuntado por si algun momento hace falta y si además te has hecho algun par de containers propios, pues nunca esta de más. La parte más dificil de crear una imagen docker, es el Dockerfile, este fichero es todo lo que contendra y hara la imagen docker cuando se cree (sobre que base funciona, que puertos, volumenes, etc…)." /> <link rel="canonical" href="https://vctrsnts.github.io/docker/2020/12/14/crear-imagen-docker.html" /> <meta property="og:url" content="https://vctrsnts.github.io/docker/2020/12/14/crear-imagen-docker.html" /> <meta property="og:site_name" content="Si lo haces, hazlo bien!" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2020-12-14T00:00:00+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Crear imagenes en docker" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"VSANTOS","url":"https://github.com/vctrsnts"},"dateModified":"2020-12-14T00:00:00+00:00","datePublished":"2020-12-14T00:00:00+00:00","description":"Esto es una cosa que queria hacer desde que he empezado a utilizar docker porque siempre va bien tenerlos apuntado por si algun momento hace falta y si además te has hecho algun par de containers propios, pues nunca esta de más. La parte más dificil de crear una imagen docker, es el Dockerfile, este fichero es todo lo que contendra y hara la imagen docker cuando se cree (sobre que base funciona, que puertos, volumenes, etc…).","headline":"Crear imagenes en docker","mainEntityOfPage":{"@type":"WebPage","@id":"https://vctrsnts.github.io/docker/2020/12/14/crear-imagen-docker.html"},"url":"https://vctrsnts.github.io/docker/2020/12/14/crear-imagen-docker.html"}</script> <!-- End Jekyll SEO tag --> <!-- RSS --> <link rel="alternate" type="application/atom+xml" title="Si lo haces, hazlo bien!" href="https://vctrsnts.github.io/feed.xml"/> <link type="application/atom+xml" rel="alternate" href="https://vctrsnts.github.io/feed.xml" title="Si lo haces, hazlo bien!" /> <!-- Twitter Cards --> <meta name="twitter:title" content="Crear imagenes en docker"> <meta name="twitter:description" content="Esto es una cosa que queria hacer desde que he empezado a utilizar docker porque siempre va bien tenerlos apuntado por si algun momento hace falta y si ademá..."> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="https://vctrsnts.github.io/assets/img/header/triangular.jpeg"> <meta name="twitter:image:alt" content="Crear imagenes en docker"> </head>
  <body>
    
    <header class="site-header"> <!-- Logo and title --> <div class="branding"> <a href="/"> <img alt="logo img" class="avatar" src="/assets/img/logo.png" loading="lazy"/> </a> <a class="site-title" aria-label="Si lo haces, hazlo bien!" href="/"> Si lo haces, hazlo bien! </a> </div> <!-- Toggle menu --> <nav class="clear"> <a aria-label="pull" id="pull" class="toggle" href="#"> <i class="fas fa-bars fa-lg"></i> </a> <!-- Menu --> <ul class="hide"> <li class="separator"> | </li> <li> <a class="clear" aria-label="About" title="About" href="/about/"> <span class="navbar-label ">About</span> </a> </li> <li class="separator"> | </li> <li> <a class="clear" aria-label="Archivo" title="Archivo" href="/archive"> <span class="navbar-label ">Archivo</span> </a> </li> <li class="separator"> | </li> <li> <a class="clear" aria-label="Tags" title="Tags" href="/tags/"> <i class="navbar-icon fas fa-tags" aria-hidden="true"></i> <span class="navbar-label navbar-label-with-icon">Tags</span> </a> </li> <li class="separator"> | </li> <li> <a class="clear" aria-label="Search" title="Search" href="/search/"> <i class="navbar-icon fas fa-search" aria-hidden="true"></i> <span class="navbar-label navbar-label-with-icon">Search</span> </a> </li> </ul> </nav> </header>
    <div class="content">
      <article >
    <header id="main" style="">
        <div class="title-padder">
            
                <h1 id="Crear+imagenes+en+docker" class="title">Crear imagenes en docker</h1>
                


<div class="post-info"><a href="https://github.com/vctrsnts" target="_blank" rel="noopener">
      <img alt="Author's avatar" src="https://avatars2.githubusercontent.com/u/816965?s=460&v=4" loading="lazy">
    
    <p class="meta">
      VSANTOS - 
      
      Diciembre 14, 2020
    </p></a></div>

            
        </div>
    </header>

    <section class="post-content">
    
            <p>Esto es una cosa que queria hacer desde que he empezado a utilizar <code class="language-plaintext highlighter-rouge">docker</code> porque siempre va bien tenerlos apuntado por si algun momento hace falta y si además te has hecho algun par de containers 
propios, pues nunca esta de más.</p>

<p>La parte más dificil de crear una imagen docker, es el <code class="language-plaintext highlighter-rouge">Dockerfile</code>, este fichero es todo lo que contendra y hara la imagen docker cuando se cree (sobre que base funciona, que puertos, volumenes, 
etc…).</p>

<!-- more -->

<p>Un ejemplo de fichero <code class="language-plaintext highlighter-rouge">Dockerfile</code> puede ser este que utilice para crear la imagen de flexget :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   FROM alpine:3.11
   LABEL maintainer <span class="s2">"wiserain"</span>

   RUN <span class="se">\</span>
     <span class="nb">echo</span> <span class="s2">"**** install frolvlad/alpine-python3 ****"</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
     apk add <span class="nt">--no-cache</span> python3 <span class="o">&amp;&amp;</span> <span class="se">\</span>
     python3 <span class="nt">-m</span> ensurepip <span class="o">&amp;&amp;</span> <span class="se">\</span>
     <span class="nb">rm</span> <span class="nt">-r</span> /usr/lib/python<span class="k">*</span>/ensurepip <span class="o">&amp;&amp;</span> <span class="se">\</span>
     pip3 <span class="nb">install</span> <span class="nt">--no-cache</span> <span class="nt">--upgrade</span> pip setuptools wheel <span class="o">&amp;&amp;</span> <span class="se">\</span>
     <span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="nt">-e</span> /usr/bin/pip <span class="o">]</span><span class="p">;</span> <span class="k">then </span><span class="nb">ln</span> <span class="nt">-s</span> pip3 /usr/bin/pip<span class="p">;</span> <span class="k">fi</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
     <span class="nb">echo</span> <span class="s2">"**** install dependencies for plugin: telegram ****"</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
     apk add <span class="nt">--no-cache</span> py3-cryptography <span class="o">&amp;&amp;</span> <span class="se">\</span>
     pip <span class="nb">install</span> <span class="nt">--upgrade</span> PySocks <span class="o">&amp;&amp;</span> <span class="se">\</span>
     pip <span class="nb">install</span> <span class="nt">--upgrade</span> python-telegram-bot <span class="o">&amp;&amp;</span> <span class="se">\</span>
     <span class="nb">echo</span> <span class="s2">"**** install dependencies for plugin: cfscraper ****"</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
     pip <span class="nb">install</span> <span class="nt">--upgrade</span> cloudscraper <span class="o">&amp;&amp;</span> <span class="se">\</span>
     apk del <span class="nt">--purge</span> <span class="nt">--no-cache</span> build-deps <span class="o">&amp;&amp;</span> <span class="se">\</span>
     <span class="nb">echo</span> <span class="s2">"**** install dependencies for plugin: convert_magnet ****"</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
     apk add <span class="nt">--no-cache</span> boost-python3 libstdc++ <span class="o">&amp;&amp;</span> <span class="se">\</span>
     <span class="nb">echo</span> <span class="s2">"**** install dependencies for plugin: misc ****"</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
     pip <span class="nb">install</span> <span class="nt">--upgrade</span> <span class="se">\</span>
       transmissionrpc <span class="se">\</span>
       irc_bot <span class="o">&amp;&amp;</span> <span class="se">\</span>
     <span class="nb">echo</span> <span class="s2">"**** install dependencies for plugin: rar ****"</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
     apk add <span class="nt">--no-cache</span> unrar <span class="o">&amp;&amp;</span> <span class="se">\</span>
     pip <span class="nb">install</span> <span class="nt">--upgrade</span> rarfile <span class="o">&amp;&amp;</span> <span class="se">\</span>
     <span class="nb">echo</span> <span class="s2">"**** install flexget ****"</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
     pip <span class="nb">install</span> <span class="nt">--upgrade</span> <span class="nt">--force-reinstall</span> flexget <span class="o">&amp;&amp;</span> <span class="se">\</span>
     <span class="c"># add default volumes</span>
     VOLUME /config /data
     WORKDIR /config
 
     <span class="c"># expose port for flexget webui</span>
     EXPOSE 3539 3539/tcp
 
     <span class="c"># run init.sh to set uid, gid, permissions and to launch flexget</span>
     RUN <span class="nb">chmod</span> +x /scripts/init.sh
     CMD <span class="o">[</span><span class="s2">"/scripts/init.sh"</span><span class="o">]</span>
</code></pre></div></div>

<p>Como se puede ver, en este caso, la base de mi imagen es <code class="language-plaintext highlighter-rouge">alpine:3.11</code> y se basa en una imagen ya creada por wiserain. Lo que yo hice fue quitar un par de cosas que no necesitaba y añadir otras porque
 a la hora de funcionar me daban error.</p>

<p>Luego viene, todo el resto de programas que tiene que hacer para que la imagen docker funcione correctamente. En este caso, el <code class="language-plaintext highlighter-rouge">Dockerfile</code> que estoy usando, es el que se usa para crear la imagen de 
<code class="language-plaintext highlighter-rouge">flexget</code>.</p>

<p>Esta, en principio es la parte más dificil de crear una imagen docker, ahora solamente nos queda subirlo a algun almacen de imagenes docker. En este caso, yo estoy dado de alta en 
<a href="https://hub.docker.com/">docker hub</a> es que donde muchas personas han colgado las imagenes que ellos han creado, para que el resto pueda utilizarla.</p>

<p>Para crear la imagen en si y luego subirla, lo primero es crear dicha imagen. Esto se hace a traves del siguiente comando (lo mejor es ejecutar esta imagen dentro del directorio donde tenemos el <code class="language-plaintext highlighter-rouge">Dockerfile</code>):</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">   usuari@debian:~$</span><span class="w"> </span>docker build <span class="nt">-t</span> usuario/nombre_imagen:version <span class="nb">.</span>
</code></pre></div></div>

<p>Con esto ya hemos creado la imagen, ahora tenemos que subir la imagen, pero antes tenemos que hacer login en nuestra cuenta de <code class="language-plaintext highlighter-rouge">dockerhub</code>:</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">   usuari@debian:~$</span><span class="w"> </span>docker login
</code></pre></div></div>

<p>Una vez ya tenemos acceso procedemos a subir la imagen :</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">   usuari@debian:~$</span><span class="w"> </span>docker push usuario/nombre_imagen:latest
</code></pre></div></div>

<p>Y ya tenemos  nuestra imagen de docker creada y subida en dockerhub.</p>

<h4 id="referencia">Referencia</h4>
<ul>
  <li><a href="https://www.atareao.es/tutorial/docker/crear-una-imagen-docker-desde-cero-y-paso-a-paso/">Crear imagen Docker</a></li>
</ul>

    
    </section>

    <!-- Social media shares -->
    
 
  




    <!-- Tag list -->
    
    


  <div class="tag-list">
    <ul>
      
        <li class="meta">Tag</li>
      

      
        <li><a class="button" href="/tags#Docker">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> Docker</p>
        </a></li>
      
    </ul>
  </div>



</article>




<!-- To change color of links in the page --> <style> header#main { background-size: cover; background-repeat: no-repeat; background-position: center; } </style> <!-- Post navigation --> <div id="post-nav"> <div id="previous-post"> <a alt="Raspberry Pi. Haciendo copias de seguridad" href="/docker/raspberry%20pi%20os/2021/01/17/rpi-copias-seguridad.html"> <p>Previous post</p> Raspberry Pi. Haciendo copias de seguridad </a> </div> <div id="next-post"> <a alt="Raspberry Pi. Instalar y configurar fail2ban" href="/raspberry%20pi%20os/seguridad/2020/11/08/rpi-usando-fail2ban.html"> <p>Next post</p> Raspberry Pi. Instalar y configurar fail2ban </a> </div> </div> <!--Utterances--> <!-- Cusdis --> <!-- Disqus -->


    </div>
    
    <footer class="site-footer"> <ul> <a href="https://creativecommons.org/licenses/by-nc/4.0/deed.ca" title="This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License" target="_blank" rel="noopener"> <span class="fa-stack fa-lg"><i class="fab fa-creative-commons fa-stack fa-lg"></i></span><span class="fa-stack fa-lg"><i class="fab fa-creative-commons-by fa-stack fa-lg"></i></span><span class="fa-stack fa-lg"><i class="fab fa-creative-commons-nc-eu fa-stack fa-lg"></i></span> </a> </ul> <p class="text"> Powered by <a href="https://jekyllrb.com/">Jekyll</a> with <a href="https://github.com/sylhare/Type-on-Strap">Type on Strap</a> </p> <div class="footer-icons"> <ul> <!-- Social icons from Font Awesome, if enabled --> <li> <a feed.xml href="/feed.xml" title="Follow RSS feed" target="_blank"> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fas fa-rss fa-stack-1x fa-inverse"></i> </span> </a> </li> <li> <a href="https://github.com/vctrsnts" title="Follow on Github" target="_blank" rel="noopener"> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-github fa-stack-1x fa-inverse"></i> </span> </a> </li> <li> <a href="https://mastodon.online/@vsantos" title="Follow on Mastodon" target="_blank" rel="noopener"> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-mastodon fa-stack-1x fa-inverse"></i> </span> </a> </li> <li> <a href="https://vctrsnts.tumblr.com/" title="Follow on Tumblr" target="_blank" rel="noopener"> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-tumblr fa-stack-1x fa-inverse"></i> </span> </a> </li> <li> <a href="https://vsantos.wordpress.com/" title="Follow on Wordpress" target="_blank" rel="noopener"> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-wordpress fa-stack-1x fa-inverse"></i> </span> </a> </li> </ul> </div> <script type="module"> mermaid.initialize({ startOnLoad: false, theme: "default" }); mermaid.run({ nodes: [...document.querySelectorAll('.language-mermaid'), ...document.querySelectorAll('.mermaid')] }); </script> </footer>
  </body>
</html>
